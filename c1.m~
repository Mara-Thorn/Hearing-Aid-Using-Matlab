clc
clear
close all
% disp('recording...');
% recObj = audiorecorder;
% recordblocking(recObj,5);
% disp('recorded');
% %%
% disp('playing recorded sound...');
% play(recObj);
% pause(7);
%%
% y = getaudiodata(recObj);
% input= 'Counting-16-44p1-mono-15secs.wav';

% input = 'audio.wav';
% [in,fs] = audioread(input);
% [y,fs] = audioread(input);
load handel.mat
fs=Fs;
y = y(:, 1);
%info = audioinfo(input);
% sound(y);
% pause(15);
figure,plot(y);
title('input');
%%
y = awgn(y,40);
noi = y;
figure,plot(y);
title('awgn');
disp('playing added noise...');
% sound(y);
% pause(15)
%%
%'Fp,Fst,Ap,Ast' (passband frequency, stopband frequency, passband ripple, stopband attenuation)
hlpf = fdesign.lowpass('Fp,Fst,Ap,Ast',3.0e3,3.5e3,0.5,50,fs);
D = design(hlpf);
x = filter(D,y);
disp('playing denoised sound');
figure,plot(x);
title('denoise');
% sound(x,fs);
% pause(15)
%% freq shaper
% g = 45;
% freqP = [1000, 1500, 2550, 4000];
f1 = fdesign.bandpass('Fst1,Fp1,Fp2,Fst2,Ast1,Ap,Ast2',1000,1500,2550,4000,60,1,60,fs);
hd = design(f1,'equiripple');
y = filter(hd,x);
freqz(hd);

%%
disp('playing frequency shaped...');
sound(y,fs);
pause(15);
%% amplitude shaper
disp('yo')
out1=fft(y);
phse=angle(out1);
mag=abs(out1)/N;
[magsig,~]=size(mag);
threshold=100;
out=zeros(magsig,1);
for i=1:magsig/2
    if(mag(i)>threshold)
        mag(i)=threshold;mag(magsig-i)=threshold;
    end
    out(i)=mag(i)*exp(j*phse(i));
    out(magsig-i)=out(i);
end
%%
outfinal=real(ifft(out))*5000;
sound(outfinal,fs);
pause(15);
disp('yoyo')

%%
load handel.mat

figure;
subplot(2,1,1);
specgram(noi);
title('Spectrogram of Original Signal 2');

subplot(2,1,2);
specgram(outfinal);
title('Spectrogram of Adjusted Signal 2');

